import { Canvas, Meta, Story } from "@storybook/addon-docs";

<Meta title="Auth Plugin Docs/How It Works" />


# How it works

##

<br/>

* ## Working
  
  <br/>
  
  * Auth plugin instance will be running with a **Dapr Sidecar** which
  is managed by your **Backend-Engine** plugin.
  
  
  <br/>
  
  
  
  * Behind the scenes your auth plugin instance is written in **Express App** 
  which is connected with your **Glue Plugin Graphql** which is running behind
  the scene.
  
  
  <br/>
  
  * Your **Backend-Engine** plugin will treat **auth plugin instance** as
  a seperatre independent microservice. Behind the scene it will handle everything.
  Like providing you baseurl to interact with your authentication application.
  
  <br/>

  * If the auth plugin is installed correctly, then you will get a folder named auth
  inside your functions folder, where your whole logic of authentication is written.

  <br/>
  
  * Your directory stucture for the **Authentication instance auth** should be something
    like this:
    <br/>

    ```
      ğŸ“¦auth
      â”£ ğŸ“‚src
      â”ƒ â”£ ğŸ“‚controllers
      â”ƒ â”ƒ â”£ ğŸ“‚authentication
      â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚graphql
      â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œmutations.ts
      â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œqueries.ts
      â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚handlers
      â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œindex.ts
      â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œsignin.ts
      â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œsignup.ts
      â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œsocialSignin.ts
      â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œuser.ts
      â”ƒ â”ƒ â”ƒ â”— ğŸ“œhelpers.ts
      â”ƒ â”ƒ â”— ğŸ“œcommons.ts
      â”ƒ â”£ ğŸ“‚providers
      â”ƒ â”ƒ â”£ ğŸ“œRoutes.ts
      â”ƒ â”ƒ â”£ ğŸ“œexpress.ts
      â”ƒ â”ƒ â”£ ğŸ“œlocals.ts
      â”ƒ â”ƒ â”— ğŸ“œpassport.ts
      â”ƒ â”£ ğŸ“‚routes
      â”ƒ â”ƒ â”£ ğŸ“œ.gitkeep
      â”ƒ â”ƒ â”— ğŸ“œauthentication.ts
      â”ƒ â”— ğŸ“œindex.ts
      â”£ ğŸ“‚views
      â”ƒ â”— ğŸ“œtoken.html
      â”£ ğŸ“œ.env
      â”£ ğŸ“œDockerfile
      â”£ ğŸ“œREADME.md
      â”£ ğŸ“œpackage.json
      â”£ ğŸ“œrouter.js
      â”£ ğŸ“œtsconfig.json
      â”— ğŸ“œtslint.json
    ```
  <br/>
  <br/>
  
  * In order to interact with this plugin there is a file named **router.js**
    present in root directory of the instance. If you open that **router.js** 
    file, you will see a string value attached to a key named **path**, this
    is the string which you need to append after your nginx url(http://localhost:9090).
  
    In my case my path value will be something like this:
    
      ```
      module.exports = () => [
        {
          "path": "/backend/auth",
          "proxy": {
          "instance": "auth:3500",
          "path": "/v1.0/invoke/auth/method/"
          }
        }
      ];
      ```
    
    <br/>
    
    So in order to access my **auth plugin instance** its base url should be
    something like this,
      
      
    **http://localhost:9090/backend/auth**
  
  <br/>
  <br/>
  
  * In order to start this plugin you need to run the following command:
    
    <br/>
    
    ```bash
      $ node glue develop:up
    ```
    
    <br/>

    This command will start running the docker image of all the instances
    and plugin you have created. Here, in this case it will start running
    your **auth plugin instance image**, inside your **Backend-Engine** container.
  
  <br/>
  <br/>

* ## Instructions to start development of auth plugin instance
  
  <br/>
  
  * Inside your **auth instance directory** you will see that there is
  directory named **src** in which there is **express** app wirtten in 
  **typescript**. You can go ahead and start your development from there.













